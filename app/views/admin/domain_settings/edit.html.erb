<h1 class="text-2xl font-bold mb-4">Edit Domain Settings</h1>
<%= form_with model: [:admin, @store], url: admin_domain_settings_path, method: :patch, local: true do |form| %>
  <div class="mb-6">
    <label class="block text-sm font-medium text-gray-700 mb-2">Choose Domain Type</label>
    <div class="flex items-center space-x-6">
      <label class="inline-flex items-center">
        <%= form.radio_button :domain_type, 'subdomain', checked: @store.custom_domain&.domain.blank? %>
        <span class="ml-2">Use Subdomain</span>
      </label>
      <label class="inline-flex items-center">
        <%= form.radio_button :domain_type, 'custom', checked: @store.custom_domain&.domain.present? %>
        <span class="ml-2">Use Custom Domain</span>
      </label>
    </div>
  </div>

  <div id="subdomain-fields" class="mb-4" style="<%= @store.custom_domain&.domain.present? ? 'display:none;' : '' %>">
    <%= form.label :subdomain, 'Subdomain', class: 'block font-medium' %>
    <div class="flex items-center">
      <%= form.text_field :subdomain, class: 'form-input mt-1 block w-full', placeholder: 'yourstore' %>
      <span class="ml-2 text-gray-500">.yourapp.com</span>
    </div>
  </div>

  <div id="custom-domain-fields" class="mb-4" style="<%= @store.custom_domain&.domain.present? ? '' : 'display:none;' %>">
    <%= form.fields_for :custom_domain, @store.custom_domain || @store.build_custom_domain do |cd_form| %>
      <%= cd_form.label :domain, 'Custom Domain', class: 'block font-medium' %>
      <%= cd_form.text_field :domain, class: 'form-input mt-1 block w-full', placeholder: 'yourdomain.com' %>
      <%= cd_form.label :status, 'Status', class: 'block font-medium mt-2' %>
      <%= cd_form.text_field :status, class: 'form-input mt-1 block w-full' %>
      <%= cd_form.label :verified_at, 'Verified At', class: 'block font-medium mt-2' %>
      <%= cd_form.datetime_select :verified_at, class: 'form-input mt-1 block w-full' %>
    <% end %>
  </div>

  <div>
    <%= form.submit 'Save Settings', class: 'btn btn-primary' %>
    <%= link_to 'Cancel', admin_domain_settings_path, class: 'btn btn-secondary ml-2' %>
  </div>
<% end %>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const subdomainFields = document.getElementById('subdomain-fields');
    const customDomainFields = document.getElementById('custom-domain-fields');
    const radios = document.querySelectorAll('input[name="store[domain_type]"]');
    radios.forEach(radio => {
      radio.addEventListener('change', function() {
        if (this.value === 'subdomain') {
          subdomainFields.style.display = '';
          customDomainFields.style.display = 'none';
        } else {
          subdomainFields.style.display = 'none';
          customDomainFields.style.display = '';
        }
      });
    });
  });
</script>
